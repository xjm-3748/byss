packag hotbitmapgg bilibili media import android annot suppress lint import android content context import android graphic rect import android media audio manag import android build import android handler import android messag import android util attribut set import android view graviti import android view key event import android view layout inflat import android view motion event import android view view import android widget frame layout import android widget imag button import android widget imag view import android widget linear layout import android widget popup window import android widget progress bar import android widget seek bar import android widget seek bar seek bar chang listen import android widget text view import hotbitmapgg bilibili media callback media player listen import hotbitmapgg bilibili util log util import hotbitmapgg ohmybilibili import hotbitmapgg bilibili media callback danmuku switch listen import hotbitmapgg bilibili media callback video listen import java util local creat hcc public class media control extend frame layout privat static final int default timeout privat static final int privat static final int privat media player listen player privat context context privat popup window window privat int anim style privat view anchor privat view root privat progress bar progress privat text view time current time privat text view titl view privat outlin text view info view privat string titl privat long durat privat boolean show privat boolean drag privat boolean instant seek true privat boolean xml fals privat imag button paus button privat audio manag privat shown listen shown listen privat hidden listen hidden listen privat boolean danmaku show fals privat danmuku switch listen danmuku switch listen privat imag view privat video listen video listen privat imag view play public void set danmaku switch listen danmuku switch listen danmuku switch listen danmuku switch listen danmuku switch listen public void set video event video listen video listen video listen video listen suppress lint handler leak privat handler handler handler overrid public void handl messag messag msg long pos switch msg case hide break case pos set progress drag show msg obtain messag send messag delay msg pos updat paus play break privat click listen paus listen paus resum show default timeout privat runnabl runnabl privat seek bar chang listen seek listen seek bar chang listen public void start track touch seek bar bar drag true show handler remov messag instant seek set stream mute audio manag true info view null info view set text info view set visibl view public void progress chang seek bar bar int progress boolean fromus fromus return final long newposit durat progress string time generat time newposit instant seek handler remov callback runnabl runnabl player seek newposit handler post delay runnabl info view null info view set text time current time null current time set text time public void stop track touch seek bar bar instant seek player seek durat bar progress info view null info view set text info view set visibl view show default timeout handler remov messag set stream mute audio manag fals drag fals handler send empti messag delay public media control context context attribut set attr super context attr root xml true init control context public media control context context super context xml init control context init float window privat static string generat time long posit int total int posit int total int minut total int hour total hour return string format local hour minut els return string format local minut privat boolean init control context context context context audio manag context system servic context return true overrid public void finish inflat super finish inflat root null init control view root privat void init float window window popup window context window set focus fals window set background drawabl null window set outsid touchabl true anim style android style anim video view public void set anchor view view view anchor view xml remov view root control view window set content view root window set width layout param window set height layout param init control view root protect view control view return layout inflat context system servic context inflat layout layout media control privat void init control view view paus button imag button find view media control play paus play imag view find view media control play paus button null play null paus button request focus paus button set click listen paus listen play request focus play set click listen paus resum show default timeout progress seek bar find view media control seekbar progress null progress instanceof seek bar seek bar seeker seek bar progress seeker set seek bar chang listen seek listen seeker set thumb offset progress set max time text view find view media control time total current time text view find view media control time current titl view text view find view media control titl titl view null titl view set text titl linear layout danmaku layout linear layout find view media control danmaku layout imag view danmaku imag imag view find view media control danmaku switch text view danmaku text text view find view media control danmaku text danmaku layout set click listen danmaku show danmaku imag set imag resourc drawabl bili player danmaku open danmaku text set text danmuku switch listen set danmaku show true danmaku show fals els danmaku imag set imag resourc drawabl bili player danmaku close danmaku text set text danmuku switch listen set danmaku show fals danmaku show true imag view find view media control set click listen video listen public void set media player media player listen player player player updat paus play seek bar public void set instant seek boolean seek drag instant seek seek drag public void show show default timeout public void set titl string titl titl view null titl view set text titl media control view public void set info view outlin text view info view privat void disabl unsupport button paus button null play null player paus paus button set enabl fals play set enabl fals public void set anim style int anim style anim style anim style suppress lint inlin api public void show int timeout show anchor null anchor window token null build build anchor set system visibl view paus button null play null paus button request focus play request focus disabl unsupport button xml set visibl view els int locat int anchor locat screen locat rect anchor rect rect locat locat locat anchor width locat anchor height window set anim style anim style window show locat anchor graviti anchor rect left show true shown listen null shown listen shown updat paus play handler send empti messag timeout handler remov messag handler send messag delay handler obtain messag timeout public boolean show return show suppress lint inlin api public void hide anchor null return show build build anchor set system visibl view tri handler remov messag xml set visibl view els window dismiss catch illeg argument log util media control alreadi remov show fals hidden listen null hidden listen hidden public void set shown listen shown listen shown listen public void set hidden listen hidden listen hidden listen privat long set progress player null drag return int posit player current posit int durat player durat progress null durat long pos posit durat progress set progress int pos int percent player buffer percentag progress set secondari progress percent durat durat time null time set text generat time durat current time null current time set text generat time posit return posit overrid public boolean touch event motion event event show default timeout return true overrid public boolean trackbal event motion event show default timeout return fals overrid public boolean dispatch key event key event event int key code event key code event repeat count key code key event key code key event key code key event paus resum show default timeout paus button null play null paus button request focus play request focus return true els key code key event player play player paus updat paus play return true els key code key event key code key event hide return true els show default timeout return super dispatch key event event privat void updat paus play root null paus button null play null return player play paus button set imag resourc drawabl bili player play paus play set imag resourc drawabl stop els paus button set imag resourc drawabl bili player play play play set imag resourc drawabl play privat void paus resum player play player paus els player start updat paus play overrid public void set enabl boolean enabl paus button null paus button set enabl enabl play null play set enabl enabl progress null progress set enabl enabl disabl unsupport button super set enabl enabl public interfac shown listen void shown public interfac hidden listen void hidden 